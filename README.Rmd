---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# widepollution

<!-- badges: start -->
<!-- badges: end -->

This package provides a set of functions aimed at aiding the processing of wide-format .csv and json files. This package works also as a wrap package for a processing and analysis workflow available in the vignette `Spatio-temporal monitoring of Madrid pollution in 2023`. In this vignette the tailored functions are applied to authoritative pollution datasets found in Madrid Open Data portal.

## Installation

You can install the development version of `regexcite` from [GitHub](https://github.com/) with:

``` r
# install.packages("devtools")
devtools::install_github("rodrigomalagon/widepollution")
```

## Example

This is a basic example which shows you how to unpivot coupled time series in a wide-format table:

```{r example}
library(widepollution)
df <- data.frame(a=c(1,2),
                  b=c(3,4),
                  X1=c(1,1),
                  Y1=c(10,10),
                  X2=c(2,2),
                  Y2=c(20,20),
                  X30=c(3,3),
                  Y30=c(30,30))
parallel_unpivot(df,'X','Y','X_series','Y_series','time','(X|Y)([[:digit:]]+)')|>
  rename_columns(c('X_series','Y_series'),c('X','Y'))
```


Another functionality in our package is json-like list handling to extract linestrings:
```{r}
json_list <- list(
      features=list(
        list(
          geometry = list(
            coordinates =list(
              c(0,0),c(0,1),c(1,1),c(1,0),c(0,0)
            )
          )
        ),
        list(
          geometry = list(
            coordinates =list(
              c(0,0),c(0,3),c(3,0),c(0,0)
            )
          )
        ),
        list(
          geometry = list(
            coordinates =list(
              c(-1,0),c(1,0),c(1,1),c(0,2),c(-1,1),c(-1,0)
            )
          )
        )
      )
    )

#This will extract and plot the second geometry
extract_linestring_from_json_list(2,json_list)
```

